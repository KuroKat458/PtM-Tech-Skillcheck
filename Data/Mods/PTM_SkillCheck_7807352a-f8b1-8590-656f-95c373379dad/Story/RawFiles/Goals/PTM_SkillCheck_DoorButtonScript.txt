Version 1
SubGoalCombiner SGC_AND
INITSECTION
DB_Button(PTM_SkillCheck_TavernButton_a48b3f06-7649-4485-9b32-e0d3113b2fdc);
DB_Door(DOOR_Double_Medium_City_House_B_000_035e24ab-bd19-4e11-a48f-325edc447af3);
KBSECTION
//INIT
IF
DB_Button(_Button)
THEN
SetVisible(_Button, 0);

//Trigger Perception Check
IF
EnteredTrigger(_Player, (TRIGGER)PTM_SkillCheck_ButtonPerceptionTrigger_33f26093-147c-4d05-b80a-8076032486d8)
AND
DB_Players(_Player)
AND
IsTagged(_Player, (TAG)PTM_SkillCheck_AttemptedButtonRoll_a74d4b47-dfd1-4bc9-bec2-e823b7b6f59a, _Tagged)
AND
_Tagged == 0
AND
DB_Button(_Button)
THEN
SetTag(_Player, (TAG)PTM_SkillCheck_AttemptedButtonRoll_a74d4b47-dfd1-4bc9-bec2-e823b7b6f59a);
RequestPassiveRoll(_Player, _Button, "Passive", "Perception", (DIFFICULTYCLASS)HiddenPerception_Easy_10a7c9ba-bc09-4c30-8cfc-ce0c6766fac7, 0, "PTM_SkillCheck_ButtonPerceptionRoll");

//Trigger Perception Check
PROC
PROC_RollResult("PTM_SkillCheck_ButtonPerceptionRoll", _Player, _Button, _Succeeded)
AND
DB_Button(_Button)
AND
DB_Players(_Player)
AND
_Succeeded == 1
THEN
SetVisible(_Button, 1);
PROC_PlayPerceptionRevealEffect(_Button, "PTM_SkillCheck_ButtonPerceptionRoll");

//Open Doors on Button Press
IF
UseFinished(_Player, (ITEM)PTM_SkillCheck_TavernButton_a48b3f06-7649-4485-9b32-e0d3113b2fdc, 1)
AND
DB_Players(_Player)
AND
DB_Door(_Door)
THEN
Unlock((ITEM)_Door);
Open((ITEM)_Door);
EXITSECTION

ENDEXITSECTION
ParentTargetEdge "__Start"
